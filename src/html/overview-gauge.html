<html>
    <head>
        <meta charset="UTF-8">
        <script src="/static/circletype.min.js"></script>
        <script src="/static/gauge.min.js"></script>
        <script src="/static/jquery.min.js"></script>
        <style>
            .wrapper {
                position: relative;
                display: inline-block;
                margin-bottom:-30px;
            }

            .text {
                position: absolute;
                text-align: center;
                width: 100%;
                line-height: 150px;
                top: 35px;
                font-size: 18px;
                font-family: tahoma;
                font-weight: 800;
                color: white;
                z-index:-10;
            }

            #gray-circle {
                background: #778899;
                border-radius: 50%;
                width: 240px;
                height: 240px;
                z-index: -90;
                position: absolute;
                top: 15px;
                left: 70px;
            }

            #black-circle {
                background: black;
                border-radius: 50%;
                width: 242px;
                height: 242px;
                z-index: -99;
                position: absolute;
                top: 14px;
                left: 69px;
            }

            .line{
                width: 240px;
                height: 47px;
                border-bottom: 1px solid black;
                position: absolute;
                z-index: 99;
                top: 88px;
                left: 70px;
            }
            
            canvas {
                position: relative;
                z-index: -10;
            }

            body {
                background-color: rgba(255,255,255,0);
                margin: 0px;
            }
        </style>
    </head>
    <body>
        <div id="black-circle"></div>
        <div id="gray-circle"></div>
        <div class="line"></div>
        <div id="power" class="wrapper">
            <div id="power-label" class="text">Power</div>
            <canvas width="380" height="150" id="power-gauge-canvas"></canvas>
        </div>
        <div id="hr" class="wrapper" style="transform: rotate(180deg) scaleX(-1);">
            <div id="hr-label" class="text" style="transform: rotate(180deg) scaleX(-1);">Heart Rate</div>        
            <canvas width="380" height="150" id="hr-gauge-canvas"></canvas>
        </div>
    </body>

    <script>
        var powerOpts = {
            angle: 0, /// The span of the gauge arc
            lineWidth: 0.44, // The line thickness
            pointer: {
                length: 0.6, // Relative to gauge radius
                strokeWidth: 0.035 // The thickness
            },
            colorStart: '#6FADCF',
            colorStop: '#8FC0DA',
            strokeColor: '#E0E0E0',
            staticZones: [
                {strokeStyle: "#30B32D", min: 0, max: $Power.Z1.Max}, //Green
                {strokeStyle: "#FFDD00", min: $Power.Z2.Min, max: $Power.Z2.Max}, // Yellow
                {strokeStyle: "#FFA500", min: $Power.Z3.Min, max: $Power.Z3.Max}, // Orange
                {strokeStyle: "#FF4500", min: $Power.Z4.Min, max: $Power.Z4.Max},  // Orange Red
                {strokeStyle: "#F03E3E", min: $Power.Z5.Min, max: $Power.Z5.Max},  // Red
                {strokeStyle: "#8B0000", min: $Power.Z6.Min, max: $Power.Z6.Max},  // Red
                {strokeStyle: "#800000", min: $Power.Z7.Min, max: $Power.Z7.Max}  // Maroon
            ],
        };

        var power = document.getElementById('power-gauge-canvas'); // your canvas element
        var powerGauge = new Gauge(power).setOptions(powerOpts); // create sexy gauge!
        powerGauge.maxValue = $Power.Z7.Max; // set max gauge value
        powerGauge.setMinValue(0);  // set min value
        powerGauge.animationSpeed = 10;
        powerGauge.set(0); // set actual value

        // ---------------------------------------

        var hrOpts = {
            angle: 0, /// The span of the gauge arc
            lineWidth: 0.44, // The line thickness
            pointer: {
                length: 0.6, // Relative to gauge radius
                strokeWidth: 0.035 // The thickness
            },
            colorStart: '#6FADCF',
            colorStop: '#8FC0DA',
            strokeColor: '#E0E0E0',
            staticZones: [
                {strokeStyle: "#30B32D", min: 0, max: $HR.Z1.Max}, //Green
                {strokeStyle: "#FFDD00", min: $HR.Z2.Min, max: $HR.Z2.Max}, // Yellow
                {strokeStyle: "#FFA500", min: $HR.Z3.Min, max: $HR.Z3.Max}, // Orange
                {strokeStyle: "#FF4500", min: $HR.Z4.Min, max: $HR.Z4.Max},  // Orange Red
                {strokeStyle: "#800000", min: $HR.Z5.Min, max: $HR.Z5.Max}  // Red
            ],
        };

        var hr = document.getElementById('hr-gauge-canvas'); // your canvas element
        var hrGauge = new Gauge(hr).setOptions(hrOpts); // create sexy gauge!
        hrGauge.maxValue = $HR.Z5.Max; // set max gauge value
        hrGauge.setMinValue(0);  // set min value
        hrGauge.animationSpeed = 10;
        hrGauge.set(0); // set actual value

        // ---------------------------------------

        window.setInterval(function() { RefreshData(); }, 500);

        function RefreshData()
        {
            $.ajax({
                type: "GET",
                url: "/power/?dataOnly=true",
                async: true,
                success: function(result) { powerGauge.set(result);},
                error: function() { powerGauge.set(0);},
            });

            $.ajax({
                type: "GET",
                url: "/hr/?dataOnly=true",
                async: true,
                success: function(result) { hrGauge.set(result);},
                error: function() { hrGauge.set(0);},
            });
        }
    </script>
</html>